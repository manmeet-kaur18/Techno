<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta content="width=device-width, initial-scale=1.0" name="viewport">

    <title>Tables / General - NiceAdmin Bootstrap Template</title>
    <meta content="" name="description">
    <meta content="" name="keywords">

    <!-- Favicons -->
    <link href="/assets/img/favicon.png" rel="icon">
    <link href="/assets/img/apple-touch-icon.png" rel="apple-touch-icon">

    <!-- Google Fonts -->
    <link href="https://fonts.gstatic.com" rel="preconnect">
    <link
        href="https://fonts.googleapis.com/css?family=Open+Sans:300,300i,400,400i,600,600i,700,700i|Nunito:300,300i,400,400i,600,600i,700,700i|Poppins:300,300i,400,400i,500,500i,600,600i,700,700i"
        rel="stylesheet">

    <!-- Vendor CSS Files -->
    <link href="/assets/vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">
    <link href="/assets/vendor/bootstrap-icons/bootstrap-icons.css" rel="stylesheet">
    <link href="/assets/vendor/remixicon/remixicon.css" rel="stylesheet">
    <link href="/assets/vendor/boxicons/css/boxicons.min.css" rel="stylesheet">
    <link href="/assets/vendor/quill/quill.snow.css" rel="stylesheet">
    <link href="/assets/vendor/quill/quill.bubble.css" rel="stylesheet">
    <link href="/assets/vendor/simple-datatables/style.css" rel="stylesheet">

    <script src="https://code.jquery.com/jquery-3.6.0.js"
        integrity="sha256-H+K7U5CnXl1h5ywQfKtSj8PCmoN9aaq30gDh27Xc0jk=" crossorigin="anonymous"></script>
    <!-- Template Main CSS File -->
    <link href="/assets/css/style.css" rel="stylesheet">
    <style>
        .bg-light-gray {
            background-color: #f7f7f7;
        }

        .table-bordered thead td,
        .table-bordered thead th {
            border-bottom-width: 2px;
        }

        .table thead th {
            vertical-align: bottom;
            border-bottom: 2px solid #dee2e6;
        }

        .table-bordered td,
        .table-bordered th {
            border: 1px solid #dee2e6;
        }


        .bg-sky.box-shadow {
            box-shadow: 0px 5px 0px 0px rgba(113, 96, 255)
        }

        .bg-orange.box-shadow {
            box-shadow: 0px 5px 0px 0px rgba(113, 96, 255)
        }

        .bg-green.box-shadow {
            box-shadow: 0px 5px 0px 0px rgba(113, 96, 255)
        }

        .bg-yellow.box-shadow {
            box-shadow: 0px 5px 0px 0px rgba(113, 96, 255)
        }

        .bg-pink.box-shadow {
            box-shadow: 0px 5px 0px 0px rgba(113, 96, 255)
        }

        .bg-purple.box-shadow {
            box-shadow: 0px 5px 0px 0px rgba(113, 96, 255)
        }

        .bg-lightred.box-shadow {
            box-shadow: 0px 5px 0px 0px rgba(113, 96, 255)
        }


        .bg-sky {
            background-color: rgba(113, 96, 255)
        }

        .bg-orange {
            background-color: rgba(113, 96, 255)
        }

        .bg-green {
            background-color: rgba(113, 96, 255)
        }

        .bg-yellow {
            background-color: rgba(113, 96, 255)
        }

        .bg-pink {
            background-color: rgba(113, 96, 255)
        }

        .bg-purple {
            background-color: rgba(113, 96, 255)
        }

        .bg-lightred {
            background-color: rgba(113, 96, 255)
        }

        .padding-15px-lr {
            padding-left: 15px;
            padding-right: 15px;
        }

        .padding-5px-tb {
            padding-top: 5px;
            padding-bottom: 5px;
        }

        .margin-10px-bottom {
            margin-bottom: 10px;
        }

        .border-radius-5 {
            border-radius: 5px;
        }

        .margin-10px-top {
            margin-top: 10px;
        }

        .font-size14 {
            font-size: 14px;
        }

        .text-light-gray {
            color: #d6d5d5;
        }

        .font-size13 {
            font-size: 13px;
        }

        .table-bordered td,
        .table-bordered th {
            border: 1px solid #dee2e6;
        }

        .table td,
        .table th {
            padding: .75rem;
            vertical-align: top;
            border-top: 1px solid #dee2e6;
        }

        button {
            margin-top: 20px;
            margin-bottom: 10px;
            margin-right: 10px;
        }

        .card-title {
            font-size: 25px;
        }
    </style>
    <!-- =======================================================
  * Template Name: NiceAdmin - v2.1.0
  * Template URL: https://bootstrapmade.com/nice-admin-bootstrap-admin-html-template/
  * Author: BootstrapMade.com
  * License: https://bootstrapmade.com/license/
  ======================================================== -->
</head>

<body>

    <!-- ======= Header ======= -->
    <header id="header" class="header fixed-top d-flex align-items-center">

        <div class="d-flex align-items-center justify-content-between">
            <a href="index.html" class="logo d-flex align-items-center">
                <img src="/assets/img/logo.png" alt="">
                <span class="d-none d-lg-block">NiceAdmin</span>
            </a>
            <i class="bi bi-list toggle-sidebar-btn"></i>

        </div><!-- End Logo -->
        </nav><!-- End Icons Navigation -->

    </header><!-- End Header -->

    <!-- ======= Sidebar ======= -->
    <aside id="sidebar" class="sidebar">
        <ul class="sidebar-nav" id="sidebar-nav">
            <li class="nav-item">
                <a class="nav-link collapsed" href="/FacultyTimeTable">
                    <i class="bi bi-grid"></i>
                    <span>Faculty Time Table</span>
                </a>
            </li><!-- End Dashboard Nav -->
            <li class="nav-item">
                <a class="nav-link collapsed" href="/Faculty_StudentInfo">
                    <i class="bi bi-grid"></i>
                    <span>Student Information</span>
                </a>
            </li><!-- End Dashboard Nav -->
            <li class="nav-item">
                <a class="nav-link collapsed" href="/ScheduleNewExam">
                    <i class="bi bi-grid"></i>
                    <span>Schedule a MCQ Exam</span>
                </a>
            </li><!-- End Dashboard Nav -->
            <li class="nav-item">
                <a class="nav-link collapsed" href="/Faculty_RecheckRequests">
                    <i class="bi bi-grid"></i>
                    <span>Recheck Requests from Students</span>
                </a>
            </li><!-- End Dashboard Nav -->
            <li>
                <a class="nav-link collapsed" href="/UploadCheckedAnswerSheets">
                    <i class="bi bi-grid"></i>
                    <span>Upload Checked Answer Sheets</span>
                </a>
            </li>
            <li>
                <a class="nav-link collapsed" href="/UpdateAnwserOnlineExam">
                    <i class="bi bi-grid"></i>
                    <span>Update Answers for Online Examination</span>
                </a>
            </li>
            <li>
                <a class="nav-link collapsed" href="/UpdateAnwserOnlineExam">
                    <i class="bi bi-grid"></i>
                    <span>Cancel a Lecture</span>
                </a>
            </li>
            <li>
                <a class="nav-link collapsed" href="/ScheduleCodingExam">
                    <i class="bi bi-grid"></i>
                    <span>Schedule a Coding Exam</span>
                </a>
            </li>
            <li>
                <a class="nav-link collapsed" href="/ScheduleOfflineExam">
                    <i class="bi bi-grid"></i>
                    <span>Schedule an Offline Written Exam</span>
                </a>
            </li>
            <li class="nav-item">
                <a class="nav-link collapsed" href="/Faculty_ResolveDoubts">
                    <i class="bi bi-grid"></i>
                    <span>Resolve Doubts of Students</span>
                </a>
            </li><!-- End Dashboard Nav -->
            <li class="nav-item">
                <a class="nav-link collapsed" href="/Faculty_UploadNotes">
                    <i class="bi bi-grid"></i>
                    <span>Upload Notes and Lectures</span>
                </a>
            </li><!-- End Dashboard Nav -->
        </ul>

    </aside><!-- End Sidebar-->

    <main id="main" class="main">

        <div class="pagetitle">
            <h1>General Tables</h1>
            <nav>
                <ol class="breadcrumb">
                    <li class="breadcrumb-item"><a href="index.html">Home</a></li>
                    <li class="breadcrumb-item">Tables</li>
                    <li class="breadcrumb-item active">General</li>
                </ol>
            </nav>
        </div><!-- End Page Title -->

        <section class="section">
            <div class="row">
                <div class="card">
                    <div class="card-body">
                        <h5 class="card-title">Upload MCQ Questions for a Exam</h5>
                        <div class="row mb-3">
                            <label for="inputEmail" class="col-sm-2 col-form-label">Exam Name</label>
                            <div class="col-sm-10">
                                <input type="text" class="form-control" id="examName">
                            </div>
                        </div>
                        <div class="row mb-3">
                            <label class="col-sm-2 col-form-label">Select Year</label>
                            <div class="col-sm-10">
                                <select class="form-select" id="year" aria-label="Default select example">
                                    <option selected>Open this select menu</option>
                                            <option value="2021">2021</option>
                                            <option value="2020">2020</option>
                                            <option value="2019">2019</option>
                                            <option value="2018">2018</option>
                                            <option value="2017">2017</option>
                                            <option value="2016">2016</option>
                                            <option value="2015">2015</option>
                                            <option value="2014">2014</option>
                                            <option value="2013">2013</option>
                                            <option value="2012">2012</option>
                                            <option value="2011">2011</option>
                                            <option value="2010">2010</option>
                                            <option value="2009">2009</option>
                                            <option value="2008">2008</option>
                                            <option value="2007">2007</option>
                                </select>
                            </div>
                        </div>
                        <div class="row mb-3">
                            <label class="col-sm-2 col-form-label">Select Semester</label>
                            <div class="col-sm-10">
                                <select class="form-select" id="Semester" aria-label="Default select example">
                                </select>
                            </div>
                        </div>
                        <div class="row mb-3">
                            <label class="col-sm-2 col-form-label">Enter Batch ID</label>
                            <div class="col-sm-10">
                                <input type="text" class="form-control" id="BatchID">
                            </div>
                        </div>
                        <div class="row mb-3">
                            <label class="col-sm-2 col-form-label">Enter Branch ID of all entered batch</label>
                            <div class="col-sm-10">
                                <input type="text" class="form-control" id="BranchDetail">
                            </div>
                        </div>
                        <div class="row mb-3">
                            <label class="col-sm-2 col-form-label">Select CourseID</label>
                            <div class="col-sm-10">
                                <select class="form-select" id="CourseID" aria-label="Default select example">
                                </select>
                            </div>
                        </div>
                        
                        <div class="row mb-3">
                            <label class="col-sm-2 col-form-label">Enter TotalMarks </label>
                            <div class="col-sm-10">
                                <input type="text" class="form-control" id="totalMarks">
                            </div>
                        </div>
                        <div class="row mb-3">
                            <label class="col-sm-2 col-form-label">Enter Date (DD-MM-YYYY)</label>
                            <div class="col-sm-10">
                                <input type="text" class="form-control" id="date">
                            </div>
                        </div>
                        <div class="row mb-3">
                            <label class="col-sm-2 col-form-label">Enter Start Time (HH-MM)</label>
                            <div class="col-sm-10">
                                <input type="text" class="form-control" id="startTime">
                            </div>
                        </div>
                        <div class="row mb-3">
                            <label for="inputEmail" class="col-sm-2 col-form-label">Enter End Time (HH:MM)</label>
                            <div class="col-sm-10">
                                <input type="text" class="form-control" id="endTime">
                            </div>
                        </div>
                        <div class="row mb-3">
                            <label for="inputEmail" class="col-sm-2 col-form-label">Enter Location</label>
                            <div class="col-sm-10">
                                <input type="text" class="form-control" id="Location">
                            </div>
                        </div>
                        <div class="row mb-3">
                            <label for="inputEmail" class="col-sm-2 col-form-label"> Number of Questions you want to add</label>
                            <div class="col-sm-10">
                                <input type="text" class="form-control" id="Number">
                            </div>
                        </div>
                        <div  id="QuestionForm">
                        </div>
                        <button type="button" class="btn btn-outline-success" id="submit">
                            Add Exam
                        </button>
                        <!-- <img src="https://drive.google.com/uc?export=view&id=1n_ur95EsONbSM5SbFicElY3oatsmCDGi"> -->
                    </div>
                </div>
            </div>
        </section>
    </main>

    <a href="#" class="back-to-top d-flex align-items-center justify-content-center"><i class="bi bi-arrow-up-short"></i></a>
    <!-- Vendor JS Files -->
    <script src="/assets/vendor/bootstrap/js/bootstrap.bundle.js"></script>
    <script src="/assets/vendor/php-email-form/validate.js"></script>
    <script src="/assets/vendor/quill/quill.min.js"></script>
    <script src="/assets/vendor/tinymce/tinymce.min.js"></script>
    <script src="/assets/vendor/simple-datatables/simple-datatables.js"></script>
    <script src="/assets/vendor/chart.js/chart.min.js"></script>
    <script src="/assets/vendor/apexcharts/apexcharts.min.js"></script>
    <script src="/assets/vendor/echarts/echarts.min.js"></script>
    <!-- Template Main JS File -->
    <script src="/assets/js/main.js"></script>
</body>
<script>
        var courselistbybranchsem={};

   $(document).ready(function () {
        var mySet1 = new Set();
        var parentdiv1 = document.getElementById('BatchID');
        parentdiv1.innerHTML="";
        var optiondiv1 = document.createElement('option');
        optiondiv1.value = "Open this select menu";
        optiondiv1.textContent = "Open this select menu";
        parentdiv1.appendChild(optiondiv1);

        $.ajax({
            type: "POST",
            url: "/getBatches",
            dataType: "json",
            success:function(msg){
                for(var x=0;x<msg.length;x++){               
                    if(mySet1.has(msg[x].BatchID)==false){
                        var optiondiv = document.createElement('option');
                        optiondiv.value = msg[x].BatchID;
                        optiondiv.textContent = msg[x].BatchID;
                        parentdiv1.appendChild(optiondiv);
                        mySet1.add(msg[x].CourseID);
                    }
                }
            },
        });
    });
    document.getElementById('year').onchange = function(){
        var mySet1 = new Set();
        var mySet2 = new Set();

        var parentdiv1 = document.getElementById('CourseID');
        var parentdiv3 = document.getElementById('Semester');
        
        parentdiv1.innerHTML="";
        var optiondiv1 = document.createElement('option');
        optiondiv1.value = "Open this select menu";
        optiondiv1.textContent = "Open this select menu";
        parentdiv1.appendChild(optiondiv1);

        parentdiv3.innerHTML="";
        var optiondiv3 = document.createElement('option');
        optiondiv3.value = "Open this select menu";
        optiondiv3.textContent = "Open this select menu";
        parentdiv3.appendChild(optiondiv3);

        var data = {
            'Year':document.getElementById('year').value
        };
        $.ajax({
                type: "POST",
                url: "/getCoursesOfferedByYear",
                dataType: "json",
                success:function(msg){
                    if(msg.length>0){
                        for(var x=0;x<msg.length;x++){
                            
                            if(mySet1.has(msg[x].CourseID)==false){
                                var optiondiv = document.createElement('option');
                                optiondiv.value = msg[x].CourseID;
                                optiondiv.textContent = msg[x].CourseID;
                                parentdiv1.appendChild(optiondiv);
                                mySet1.add(msg[x].CourseID);
                            }

                            var str = msg[x].BranchID+'-'+msg[x].Semester;
                        if(str in courselistbybranchsem){
                            courselistbybranchsem[msg[x].BranchID+'-'+msg[x].Semester].add(msg[x].CourseID);
                        }
                        else{
                            courselistbybranchsem[str] = new Set();
                            courselistbybranchsem[str].add(msg[x].CourseID);   
                        }

                            if(mySet2.has(msg[x].Semester)==false){
                                var optiondiv2 = document.createElement('option');
                                optiondiv2.value = msg[x].Semester;
                                optiondiv2.textContent = msg[x].Semester;
                                parentdiv3.appendChild(optiondiv2);
                                mySet2.add(msg[x].Semester);
                            }
                        }
                    }
                },
                data:data,
        });
    }
    document.getElementById('Number').oninput=function(){
        var t = document.getElementById('Number').value;
        var parent = document.getElementById('QuestionForm');
        parent.innerHTML = "";

        for(var x=0;x<t;x++){
            
            // question
            var div1 = document.createElement('div');
            div1.setAttribute('class','row mb-3');
            var div2 = document.createElement('label');
            div2.setAttribute('class','col-sm-2 col-form-label');
            div2.textContent = "Question : "+x;
            var div3 = document.createElement('div');
            div3.setAttribute('class','col-sm-10');

            var input = document.createElement('input');
            input.setAttribute("type","text");
            input.setAttribute("class","form-control");
            input.id = "question"+x;
            
            div3.appendChild(input);
            div1.appendChild(div2);
            div1.appendChild(div3);
            parent.appendChild(div1);
            
            //marks
            var div4 = document.createElement('div');
            div4.setAttribute('class','row mb-3');
            var div5 = document.createElement('label');
            div5.setAttribute('class','col-sm-2 col-form-label');
            var div6 = document.createElement('div');
            div6.setAttribute('class','col-sm-10');

            div5.textContent = "Marks of this Question : "+x;
            var input1 = document.createElement('input');
            input1.setAttribute("type","text");
            input1.setAttribute("class","form-control");
            input1.id = "marks"+x;

            div6.appendChild(input1);
            div4.appendChild(div5);
            div4.appendChild(div6);
            parent.appendChild(div4);

            // //ans list
            // var div7 = document.createElement('div');
            // div7.setAttribute('class','row mb-3');
            // var div8 = document.createElement('label');
            // div8.setAttribute('class','col-sm-2 col-form-label');
            // var div9 = document.createElement('div');
            // div9.setAttribute('class','col-sm-10');

            // div8.textContent = "Options of this Question (Comma seperated list) : "+x;
            // var input2 = document.createElement('input');
            // input2.setAttribute("type","text");
            // input2.setAttribute("class","form-control");
            // input2.id = "anslist"+x;

            // div9.appendChild(input2);
            // div7.appendChild(div8);
            // div7.appendChild(div9);
            // parent.appendChild(div7);

            // //CorrectAnswer
            // var div10 = document.createElement('div');
            // div10.setAttribute('class','row mb-3');
            // var div11 = document.createElement('label');
            // div11.setAttribute('class','col-sm-2 col-form-label');
            // div11.textContent = "Correct Answers of Question : "+x;
            // var div12 = document.createElement('div');
            // div12.setAttribute('class','col-sm-10');
            // var input3 = document.createElement('input');
            // input3.setAttribute("type","text");
            // input3.setAttribute("class","form-control");
            // input3.id = "correctAns"+x;

            // div12.appendChild(input3);
            // div10.appendChild(div11);
            // div10.appendChild(div12);
            // parent.appendChild(div10);

        }
    }
    var button = document.getElementById('submit');
    button.addEventListener('click',function (e){
        var questionsinfo = [];
        var t = document.getElementById('Number').value;
        for(var x=0;x<t;x++){
            var d = {};
            d["questionid"]=x+1;
            d["question"]=document.getElementById('question'+x).value;
            d["marks"]=document.getElementById('marks'+x).value;
            questionsinfo.push(d);
        }
        
        var TeacherSem = "1";
        if(parseInt(document.getElementById('Semester').value)%2==0){
            TeacherSem = "2";
        }
        var branchlist = [];
        var batchlist = [];
        branchlist = document.getElementById('BranchDetail').value.split(',');
        batchlist = document.getElementById('BatchID').value.split(',');
        var courseslist = [];
        var set1 = new Set();
        var Semester = document.getElementById('Semester').value;

        for(var x=0;x<branchlist.length;x++){
            courselistbybranchsem[branchlist[x]+'-'+Semester].forEach(a => { 
                if(set1.has(a)==false){
                    set1.add(a);
                    courseslist.push(a);
                }
             })
        }

        var dataarray = [];
        for(var x=0;x<batchlist.length;x++){
        var data = {
            'examName':document.getElementById('examName').value,
            'Year':document.getElementById('year').value,
            'Semester':document.getElementById('Semester').value,
            'Questions':questionsinfo,
            'Type':'Written',
            'TotalMarks':document.getElementById('totalMarks').value,
            'CourseID':document.getElementById('CourseID').value,
            'Date':document.getElementById('date').value,
            'StartTime':document.getElementById('startTime').value,
            'EndTime':document.getElementById('endTime').value,
            'TeacherSem':TeacherSem,
            'Location':document.getElementById('Location').value
        }
            dataarray.push(data);
        }

        var lists ={
            'BatchList':batchlist,
            'CourseList':courseslist,
            'Semester':Semester,
            'Date':document.getElementById('date').value
        } 

        dataarray.push(lists);

        var data1 = {'data':dataarray};

        $.ajax({
                type: "POST",
                url: "/AddExam",
                dataType: "json",
                success: function (msg) {
                    if(msg[0].status==true){
                        location.href="/ScheduleOfflineExam";
                    }      
                    else{
                        alert("You are trying to Allocate a Time in which Exam is Already Scheduled or Please Check Internet Connection and Try Again");
                    }                
                },
                data:data1
            });
            
    })
</script>
</html>
