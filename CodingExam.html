<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta content="width=device-width, initial-scale=1.0" name="viewport">

    <title>Forms / Layouts - NiceAdmin Bootstrap Template</title>
    <meta content="" name="description">
    <meta content="" name="keywords">

    <!-- Favicons -->
    <link href="/assets/img/favicon.png" rel="icon">
    <link href="/assets/img/apple-touch-icon.png" rel="apple-touch-icon">

    <!-- Google Fonts -->
    <link href="https://fonts.gstatic.com" rel="preconnect">
    <link
        href="https://fonts.googleapis.com/css?family=Open+Sans:300,300i,400,400i,600,600i,700,700i|Nunito:300,300i,400,400i,600,600i,700,700i|Poppins:300,300i,400,400i,500,500i,600,600i,700,700i"
        rel="stylesheet">

    <!-- Vendor CSS Files -->
    <link href="/assets/vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">
    <link href="/assets/vendor/bootstrap-icons/bootstrap-icons.css" rel="stylesheet">
    <link href="/assets/vendor/remixicon/remixicon.css" rel="stylesheet">
    <link href="/assets/vendor/boxicons/css/boxicons.min.css" rel="stylesheet">
    <link href="/assets/vendor/quill/quill.snow.css" rel="stylesheet">
    <link href="/assets/vendor/quill/quill.bubble.css" rel="stylesheet">
    <link href="/assets/vendor/simple-datatables/style.css" rel="stylesheet">
    <script src="https://code.jquery.com/jquery-3.6.0.js"
        integrity="sha256-H+K7U5CnXl1h5ywQfKtSj8PCmoN9aaq30gDh27Xc0jk=" crossorigin="anonymous"></script>
    <!-- Template Main CSS File -->
    <link href="/assets/css/style.css" rel="stylesheet">
    <script src="https://code.jquery.com/jquery-3.6.0.js"
        integrity="sha256-H+K7U5CnXl1h5ywQfKtSj8PCmoN9aaq30gDh27Xc0jk=" crossorigin="anonymous"></script>
    <!-- =======================================================
  * Template Name: NiceAdmin - v2.1.0
  * Template URL: https://bootstrapmade.com/nice-admin-bootstrap-admin-html-template/
  * Author: BootstrapMade.com
  * License: https://bootstrapmade.com/license/
  ======================================================== -->
    <style>
        .card {
            padding: 5px;
        }

        #demo {
            border-radius: 13px;
            font-weight: 1000;
            background: rgb(113, 96, 255);
            height: auto;
            /* width: 15%; */
            padding: 1.0%;
            color: white;
            font-size: 100%;
        }

        button {
            background: rgb(113, 96, 255) !important;
        }

        select {
            margin-bottom: 15px;
        }

        textarea {
            margin-bottom: 15px;
        }

        .btn-outline-primary {
            color: white !important;
            margin-right: 10px;
            border-color: rgba(113, 96, 255);
        }

        textarea {
            height: 300px;
            overflow-y: scroll;

        }
    </style>

</head>

<body>
    <!-- ======= Header ======= -->
    <header id="header" class="header fixed-top d-flex align-items-center">

        <div class="d-flex align-items-center justify-content-between">
            <a href="index.html" class="logo d-flex align-items-center">
                <img src="/assets/img/logo.png" alt="">
                <span class="d-none d-lg-block">NiceAdmin</span>
            </a>
            <i class="bi bi-list toggle-sidebar-btn"></i>
        </div><!-- End Logo -->

    </header><!-- End Header -->

    <!-- ======= Sidebar ======= -->
    <aside id="sidebar" class="sidebar">

        <ul class="sidebar-nav" id="sidebar-nav">
            <li class="nav-item">
                <a class="nav-link collapsed" href="/home">
                    <i class="bi bi-grid"></i>
                    <span>Student Timetable</span>
                </a>
            </li><!-- End Dashboard Nav -->
            <li class="nav-item">
                <a class="nav-link collapsed" href="/Student_Attendance">
                    <i class="bi bi-grid"></i>
                    <span>Student Attendance</span>
                </a>
            </li><!-- End Dashboard Nav -->
            <li class="nav-item">
                <a class="nav-link collapsed" href="/Student_FacultyContactInfo">
                    <i class="bi bi-grid"></i>
                    <span>Faculty Contact Information</span>
                </a>
            </li>
            <li class="nav-item">
                <a class="nav-link collapsed" href="/Student_ExamInfo">
                    <i class="bi bi-grid"></i>
                    <span>Online Exams Information</span>
                </a>
            </li>
            <li class="nav-item">
                <a class="nav-link collapsed" href="/Student_OfflineExamInfo">
                    <i class="bi bi-grid"></i>
                    <span>Offline Written Exams Information</span>
                </a>
            </li>
        </ul>
    </aside>

    <main id="main" class="main">

        <div class="pagetitle">
            <h1>Form Layouts</h1>
            <nav>
                <ol class="breadcrumb">
                    <li class="breadcrumb-item"><a href="index.html">Home</a></li>
                    <li class="breadcrumb-item">Forms</li>
                    <li class="breadcrumb-item active">Layouts</li>
                </ol>
                <p id="demo"></p>
            </nav>
        </div><!-- End Page Title -->
        <section class="section">
            <div class="row">
                <div class="card">
                    <div class="card-body">
                        <h5 class="card-title">Vertical Form</h5>
                        <!-- Vertical Form -->
                        <div class="row g-3" id="Questions">
                        </div>
                        <button type="button" style="width:100%;margin-top:30px;" class="btn btn-primary" id="submit">Submit</button>
                    </div>
                </div>
            </div>
        </section>
        <script>
        </script>
    </main><!-- End #main -->
    <a href="#" class="back-to-top d-flex align-items-center justify-content-center"><i
            class="bi bi-arrow-up-short"></i></a>

    <!-- Vendor JS Files -->
    <script src="/assets/vendor/bootstrap/js/bootstrap.bundle.js"></script>
    <script src="/assets/vendor/php-email-form/validate.js"></script>
    <script src="/assets/vendor/quill/quill.min.js"></script>
    <script src="/assets/vendor/tinymce/tinymce.min.js"></script>
    <script src="/assets/vendor/simple-datatables/simple-datatables.js"></script>
    <script src="/assets/vendor/chart.js/chart.min.js"></script>
    <script src="/assets/vendor/apexcharts/apexcharts.min.js"></script>
    <script src="/assets/vendor/echarts/echarts.min.js"></script>

    <!-- Template Main JS File -->
    <script src="/assets/js/main.js"></script>

</body>
<script>
    var countDownDate = new Date("Jan 5, 2022 15:37:25").getTime();
    var totalQuestion;
    $(document).ready(function () {
        var parent = document.getElementById('Questions');
        parent.innerHTML = "";
        $.ajax({
            type: "POST",
            url: "/getCodingExamDetails",
            dataType: "json",
            success: function (msg) {
                if (msg.length > 0) {
                    var month = msg[0].Date.split('-')[1]
                    var date = msg[0].Date.split('-')[0]
                    var year = msg[0].Date.split('-')[2]
                    totalQuestion = msg[0].Questions.length;
                    countDownDate = new Date(month+"-"+date+"-"+ year + " " + msg[0].EndTime).getTime();
                    var x = setInterval(function () {
                        var now = new Date().getTime();
                        var distance = countDownDate - now;
                        var days = Math.floor(distance / (1000 * 60 * 60 * 24));
                        var hours = Math.floor((distance % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
                        var minutes = Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60));
                        var seconds = Math.floor((distance % (1000 * 60)) / 1000);
                        document.getElementById("demo").innerHTML = "Time - " + days + "d " + hours + "h "+ minutes + "m " + seconds + "s ";
                        if (distance < 0) {
                            clearInterval(x);
                            document.getElementById("demo").innerHTML = "EXPIRED";

                            var buttn = document.getElementById("submit");
                            buttn.disabled = true;
                        }
                    }, 1000);
                    var div1 = document.createElement('div');
                    div1.setAttribute('class', 'col-12');

                    for (var x = 0; x < msg[0].Questions.length; x++) {

                        var label1 = document.createElement('div');
                        label1.setAttribute('class', 'form-label');
                        var heading1 = document.createElement('h1');
                        heading1.textContent = "Question " + (x + 1).toString();
                        label1.appendChild(heading1);
                        div1.appendChild(label1);

                        // var br1 = document.createElement('br');
                        // div1.appendChild(br1);

                        var label4 = document.createElement('label');
                        label4.setAttribute('class', 'form-label');
                        label4.textContent = msg[0].Questions[x].question;
                        div1.appendChild(label4);


                        var br2 = document.createElement('br');
                        div1.appendChild(br2);

                        let text = msg[0].Questions[x].stcinput;
                        const myArray = text.split("],[");
                        myArray[0] = myArray[0].replace("[[", "")
                        myArray[myArray.length - 1] = myArray[myArray.length - 1].replace("]]", "");

                        text = msg[0].Questions[x].stcoutput;
                        const myArray1 = text.split("],[");
                        myArray1[0] = myArray1[0].replace("[[", "")
                        myArray1[myArray1.length - 1] = myArray1[myArray1.length - 1].replace("]]", "");

                        for (var y = 0; y < myArray.length; y++) {
                            var divcard = document.createElement('div');
                            divcard.setAttribute('class', 'card');
                            var divcardbody = document.createElement('div');
                            divcardbody.setAttribute('class', 'card-body');

                            var button = document.createElement('button');
                            button.setAttribute('class', 'btn btn-outline-primary');
                            button.textContent = "Test Case " + (y + 1);
                            button.setAttribute('data-bs-toggle', "modal");
                            button.setAttribute('data-bs-target', '#basicModal');

                            var heading2 = document.createElement('h5');
                            heading2.setAttribute('class', 'card-title');
                            heading2.textContent = "Input ";

                            var str = myArray[y].replace(/,/g, '<br>');
                            var p1 = document.createElement('p');
                            p1.innerHTML = str;

                            var heading3 = document.createElement('h5');
                            heading3.setAttribute('class', 'card-title');
                            heading3.textContent = "Output ";

                            var str1 = myArray1[y].replace(/,/g, '<br>');
                            var p2 = document.createElement('p');
                            p2.innerHTML = str1;

                            divcardbody.appendChild(button);
                            divcardbody.appendChild(heading2);
                            divcardbody.appendChild(p1);
                            divcardbody.appendChild(heading3);
                            divcardbody.appendChild(p2);
                            divcard.appendChild(divcardbody);
                            div1.appendChild(divcard);
                        }

                        var divselect = document.createElement('div');
                        divselect.setAttribute('class', 'col-md-4');
                        var label2 = document.createElement('label');
                        label2.setAttribute('class', 'form-label');
                        label2.textContent = "Choose a programming language";
                        divselect.appendChild(label2);

                        var select = document.createElement('select');
                        select.id = "Programming " + (x + 1).toString();
                        select.setAttribute('class', 'form-select');

                        var option1 = document.createElement('option');
                        option1.value = "cpp";
                        option1.textContent = "C++";

                        var option2 = document.createElement('option');
                        option2.value = "c";
                        option2.textContent = "C";

                        var option3 = document.createElement('option');
                        option3.value = "cs";
                        option3.textContent = "C#";

                        var option4 = document.createElement('option');
                        option4.value = "java";
                        option4.textContent = "Java";

                        var option5 = document.createElement('option');
                        option5.value = "py";
                        option5.textContent = "Python";

                        var option6 = document.createElement('option');
                        option6.value = "rb";
                        option6.textContent = "Ruby";

                        var option7 = document.createElement('option');
                        option7.value = "kt";
                        option7.textContent = "Kotlin";

                        var option8 = document.createElement('option');
                        option8.value = "swift";
                        option8.textContent = "Swift";

                        select.appendChild(option1);
                        select.appendChild(option2);
                        select.appendChild(option3);
                        select.appendChild(option4);
                        select.appendChild(option5);
                        select.appendChild(option6);
                        select.appendChild(option7);
                        select.appendChild(option8);
                        divselect.appendChild(select);
                        div1.appendChild(divselect);

                        var textArea = document.createElement('textarea');
                        textArea.setAttribute('class', 'form-control');
                        textArea.id = "answer" + (x + 1);
                        div1.appendChild(textArea);

                        var button1 = document.createElement('button');
                        button1.setAttribute('class', 'btn btn-outline-primary');
                        button1.textContent = "Run Sample TestCases";
                        var t = x + 1;
                        var str = "RunSampleTestCases('" + t + "')";
                        button1.setAttribute('onclick', str);
                        div1.appendChild(button1);

                        var button2 = document.createElement('button');
                        button2.setAttribute('class', 'btn btn-outline-primary');
                        button2.textContent = "Run Test Cases";
                        var t = x + 1;
                        var str = "RunTestCases('" + t + "','" + msg[0].Questions[x].marks + "')";
                        button2.setAttribute('onclick', str);
                        div1.appendChild(button2);

                        var para1 = document.createElement('div');
                        para1.id = "SampleRunResult" + (x + 1);
                        div1.appendChild(para1);

                        var para2 = document.createElement('div');
                        para2.id = "RunResult" + (x + 1);
                        div1.appendChild(para2);
                    }
                    parent.appendChild(div1);
                }
            },
        })
    })

    function RunSampleTestCases(questionid){
        var parent = document.getElementById('SampleRunResult'+questionid);
        parent.innerHTML="";
        var parent1 = document.getElementById('RunResult'+questionid);
        parent1.innerHTML="";

        var data  = {
            'questionid':questionid,
            'code':document.getElementById('answer'+questionid).value,
            'language':document.getElementById('Programming '+questionid).value
        }

        var heading = document.createElement('h5');
        heading.setAttribute('class','card-title');
        heading.textContent="Sample Test Case Result";
        parent.appendChild(heading);

        var br1 = document.createElement('br');
        parent.appendChild(br1);

        $.ajax({
            type: "POST",
            url: "/getSampleTestcaseResult",
            dataType: "json",
            success: function (msg) {
                if(msg.length>0){
                    for(var x=0;x<msg[0].Testcases.length;x++){
                        var label = document.createElement('label');
                        label.setAttribute('class','form-label');
                        label.textContent="Test Case "+(x+1).toString()+" : "+msg[0].Testcases[x].status;
                        var br = document.createElement('br');
                        parent.appendChild(label);
                        parent.appendChild(br);
                    }
                }
            },
            data:data
        });
    }

    function RunTestCases(questionid,marks){
        var parent = document.getElementById('RunResult'+questionid);
        parent.innerHTML="";
        var parent1 = document.getElementById('SampleRunResult'+questionid);
        parent1.innerHTML="";

        var data  = {
            'questionid':questionid,
            'code':document.getElementById('answer'+questionid).value,
            'language':document.getElementById('Programming '+questionid).value,
            'marks':marks
        }

        var heading = document.createElement('h5');
        heading.setAttribute('class','card-title');
        heading.textContent="Test Case Result";
        parent.appendChild(heading);

        var br1 = document.createElement('br');
        parent.appendChild(br1);

        $.ajax({
            type: "POST",
            url: "/getTestcaseResult",
            dataType: "json",
            success: function (msg) {
                parent.innerHTML="";
                if(msg.length>0){
                    for(var x=0;x<msg[0].Testcases.length;x++){
                        var label = document.createElement('label');
                        label.setAttribute('class','form-label');
                        label.textContent="Test Case "+(x+1).toString()+" : "+msg[0].Testcases[x].status;
                        var br = document.createElement('br');
                        parent.appendChild(label);
                        parent.appendChild(br);
                    }
                    var label2 = document.createElement('label');
                    label2.id = "MarksObtained"+questionid;
                    label2.setAttribute('class','form-label');
                    label2.textContent = "Your Marks Obtained in this Question  : "+msg[0].marks; 
                    parent.appendChild(label2);
                }
            },
            data:data
        });
    }

    var button = document.getElementById('submit');
    button.addEventListener('click',function(e){
        var data={
            StudentAnswers:[]
        };
        var totalmarks = 0;
        for(var x=0;x<totalQuestion;x++){
            var t1={
                'questionid':(x+1).toString(),
                'Ans':document.getElementById('answer'+(x+1).toString()).value,
                'marks':parseInt(document.getElementById('MarksObtained'+(x+1).toString()).textContent.split(':')[1]).toString()
            };
            totalmarks = totalmarks + parseInt(document.getElementById('MarksObtained1').textContent.split(':')[1]);
            data.StudentAnswers.push(t1);
        }
        data['totalmarks']=totalmarks.toString();
        $.ajax({
            type: "POST",
            url: "/SubmitTest",
            dataType: "json",
            success: function (msg) {
                if(msg.length>0){
                    location.href="/Student_ExamInfo";
                }
            },
            data:data
        });
    })
</script>

</html>